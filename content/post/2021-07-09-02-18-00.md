---
title: "Centos 7-8 通过snap安装配置shadowsocks-libev"
date: 2021-07-09T02:18:00+0000
slug: 146
categories:
  - 电脑网络
---




1、安装和启用EPEL Repository

    yum install epel-release -y

2、安装snap
通过snap来安装应用可以运行在单独的环境不影响主机系统。

    yum install snapd

添加snap启动通信 socket

    systemctl enable --now snapd.socket

创建链接（snap软件包一般安装在/snap目录下）

    ln -s /var/lib/snapd/snap /snap

3、安装shadowsocks-libev稳定版

    snap install shadowsocks-libev

4、建立shadowsocks-libev配置文件

    vim /snap/bin/config.json

注意：配置文件位置变了，不同于直接安装时 /etc/shadowsocks/config.json

输入以下内容：

    {
    "server": "0.0.0.0",
    "nameserver": "8.8.8.8",
    "server\_port": 10808,
    "password": "hk123456",
    "method": "chacha20-ietf-poly1305",
    "timeout": 600,
    "no\_delay": true,
    "mode": "tcp\_and\_udp",
    "plugin": "",
    "plugin\_opts": ""
    }

5、建立shadowsocks-libev的service单元配置文件

    vim /lib/systemd/system/ss.service

输入以下内容：

    [Unit]
    Description=Shadowsocks Server
    After=network.target
    
    [Service]
    Restart=on-abnormal
    ExecStart=/snap/bin/shadowsocks-libev.ss-server -c /snap/bin/config.json > /dev/null 2>&1
    
    [Install]
    WantedBy=multi-user.target

6、设置开机启动shadowsocks-libev

    systemctl daemon-reload
    systemctl start ss.service
    systemctl enable ss.service

7. 防火墙开放shadowsocks-libev服务端口：

    firewall-cmd --permanent --add-port=自定义服务端口/tcp
    firewall-cmd --permanent --add-port=自定义服务端口/udp
    firewall-cmd --reload

8. 常用操作
停止shadowsocks-libev服务

    systemctl stop ss.service

取消shadowsocks-libev开机自启

    systemctl disable ss.service

升级shadowsocks-libev版本

    snap refresh shadowsocks-libev

移除shadowsocks-libev应用（还需要手工清理上文第四节第五节涉及的配置文件）

    snap remove shadowsocks-libev
